import{a as k}from"./axios-G2rPRu76.js";import{_ as C,a as P,m as I,h as d,o as p,c as u,i as a,b as e,F as f,r as L,e as n,t as _,d as S,j as h,n as c}from"./index-r1H8yIGC.js";import{c as g}from"./cartStore-LMquo9uB.js";import{P as U}from"./ProgessBarComponent-bOmKu1Fc.js";import{L as T}from"./LoadingComponent-cf4BCbl2.js";import{t as v}from"./sweetalert-1w20vat0.js";var E={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"taiwang",BASE_URL:"/Vue-week8-homework/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:A,VITE_APIPATH:N}=E,B={components:{ProgessBarComponent:U,LoadingComponent:T},data(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!0}},methods:{...P(g,["getCart"]),isPhone(o){return/^(09)[0-9]{8}$/.test(o)?!0:"請輸入 09 開頭的手機號碼"},submitOrder(){k.post(`${A}/api/${N}/order`,{data:this.form}).then(o=>{const{orderId:s}=o.data;v("top","success","訂單已成立"),localStorage.removeItem("pickUp"),setTimeout(()=>{this.getCart(),this.$router.push(`/payment/${s}`)},1500)}).catch(()=>{v("top","error","表單送出失敗")})}},computed:{...I(g,["cart"]),isFormComplete(){const{user:o}=this.form;return!o.name||!o.email||!o.tel||!o.address}},mounted(){localStorage.getItem("pickUp")==="自取"&&(this.form.user.address="自取",this.$refs.address.$el.setAttribute("readonly","readonly"))},created(){setTimeout(()=>this.isLoading=!1,400)}},O={class:"bg-wave"},R={class:"container"},q={class:"col-lg-10 mx-auto pb-72"},D={class:"row justify-content-between gy-48 gy-lg-0"},F={class:"col-lg-6"},j={class:"table-responsive"},H={class:"table table-borderless mb-0"},M=e("thead",{class:"border-bottom border-dark border-top-0 border-start-0 border-end-0 border-2 text-nowrap"},[e("tr",{class:"text-center"},[e("th",{scope:"col",class:"bg-wave",style:{width:"100px"}},"示意圖"),e("th",{scope:"col",class:"bg-wave"},"餐點名稱"),e("th",{scope:"col",class:"bg-wave"},"餐點數量"),e("th",{scope:"col",class:"bg-wave"},"單價")])],-1),z={class:"text-center text-nowrap"},G={scope:"row",class:"fw-normal bg-wave"},J=["src","alt"],K={class:"bg-wave"},Q={class:"bg-wave"},W={class:"bg-wave"},X={class:"text-notoSans"},Y={class:"text-end fw-bold fs-5 mt-16 mb-0"},Z=e("span",{class:"me-8"},"總計：",-1),$={class:"text-notoSans"},ee={key:0,class:"text-end fw-bold text-danger"},se={class:"col-lg-5"},oe={class:"border border-gray bg-white rounded-2 p-20"},te=e("h2",{class:"h4 text-center fw-bold mb-24"},"訂購資訊",-1),ae={class:"mb-16"},le=e("label",{for:"name",class:"form-label"},[n("姓名 "),e("span",{class:"text-danger"},"*")],-1),re={class:"mb-16"},ne=e("label",{for:"tel",class:"form-label"},[n("手機 "),e("span",{class:"text-danger"},"*")],-1),de={class:"mb-16"},ie=e("label",{for:"email",class:"form-label"},[n("Email "),e("span",{class:"text-danger"},"*")],-1),ce={class:"mb-16"},me=e("label",{for:"address",class:"form-label"},[n("地址 "),e("span",{class:"text-danger"},"*")],-1),pe={class:"mb-24"},ue=e("label",{for:"備註",class:"form-label"},"備註",-1),_e={class:"d-flex justify-content-between"},be=["disabled"];function fe(o,s,he,ge,l,b){const w=d("LoadingComponent"),x=d("ProgessBarComponent"),i=d("v-field"),m=d("error-message"),y=d("RouterLink"),V=d("v-form");return p(),u(f,null,[a(w,{active:l.isLoading,"onUpdate:active":s[0]||(s[0]=t=>l.isLoading=t)},null,8,["active"]),e("div",O,[e("div",R,[e("div",q,[a(x),e("div",D,[e("div",F,[e("div",j,[e("table",H,[M,e("tbody",z,[(p(!0),u(f,null,L(o.cart.carts,t=>(p(),u("tr",{key:t.id,class:"align-middle border-bottom border-dark"},[e("th",G,[e("img",{src:t.product.imageUrl,alt:t.product.title,style:{width:"100px",height:"100px"}},null,8,J)]),e("td",K,_(t.product.title),1),e("td",Q,_(t.qty),1),e("td",W,[n("NT$ "),e("span",X,_(t.product.price),1)])]))),128))])])]),e("p",Y,[Z,n("NT$ "),e("span",$,_(Math.round(o.cart.final_total)),1)]),o.cart.final_total!==o.cart.total?(p(),u("p",ee,"(已使用優惠代碼)")):S("",!0)]),e("div",se,[e("div",oe,[te,a(V,{ref:"form",onSubmit:b.submitOrder},{default:h(({errors:t})=>[e("div",ae,[le,a(i,{id:"name",name:"姓名",type:"text",class:c(["form-control border-gray",{"is-invalid":t.姓名}]),modelValue:l.form.user.name,"onUpdate:modelValue":s[1]||(s[1]=r=>l.form.user.name=r),placeholder:"請輸入姓名",rules:"required"},null,8,["modelValue","class"]),a(m,{name:"姓名",class:"invalid-feedback fw-bold"})]),e("div",re,[ne,a(i,{id:"tel",name:"手機",type:"tel",class:c(["form-control border-gray",{"is-invalid":t.手機}]),modelValue:l.form.user.tel,"onUpdate:modelValue":s[2]||(s[2]=r=>l.form.user.tel=r),placeholder:"請輸入手機號碼",rules:b.isPhone},null,8,["modelValue","class","rules"]),a(m,{name:"手機",class:"invalid-feedback fw-bold"})]),e("div",de,[ie,a(i,{id:"email",name:"email",type:"email",class:c(["form-control border-gray",{"is-invalid":t.email}]),modelValue:l.form.user.email,"onUpdate:modelValue":s[3]||(s[3]=r=>l.form.user.email=r),placeholder:"請輸入 Email",rules:"email|required"},null,8,["modelValue","class"]),a(m,{name:"email",class:"invalid-feedback fw-bold"})]),e("div",ce,[me,a(i,{id:"address",name:"地址",type:"text",class:c(["form-control border-gray",{"is-invalid":t.地址}]),modelValue:l.form.user.address,"onUpdate:modelValue":s[4]||(s[4]=r=>l.form.user.address=r),placeholder:"請輸入地址",rules:"required",ref:"address"},null,8,["modelValue","class"]),a(m,{name:"地址",class:"invalid-feedback fw-bold"})]),e("div",pe,[ue,a(i,{as:"textarea",id:"備註",name:"備註",class:c(["form-control border-gray",{"is-invalid":t.備註}]),modelValue:l.form.message,"onUpdate:modelValue":s[5]||(s[5]=r=>l.form.message=r),style:{height:"150px"}},null,8,["modelValue","class"])]),e("div",_e,[a(y,{to:"/cart",class:"btn btn-outline-dark"},{default:h(()=>[n("回上一頁")]),_:1}),e("button",{type:"submit",class:"btn btn-primary text-white",disabled:b.isFormComplete},"送出訂單",8,be)])]),_:1},8,["onSubmit"])])])])])])])],64)}const Ce=C(B,[["render",fe]]);export{Ce as default};
